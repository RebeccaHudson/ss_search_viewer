{% load staticfiles %}
<head>
  <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>atsnp data</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <link href="{% static 'ss_viewer/css/bootstrap.min.css' %}" rel="stylesheet">
  <link href="{% static 'ss_viewer/lavish-bootstrap.css' %}" rel="stylesheet">
  <link href="{% static 'ss_viewer/custom.css' %}" rel="stylesheet">
</head>
<body>

<div class="container">
<div id="content">

<h2 >Search ATSNP output</h2>
<div id="status_message"> {{ status_message }} </div>

<ul id="tabs" class="nav nav-tabs", data-tabs="tabs">

  <li {%if active_tab == 'gl-region' or active_tab == 'none-yet'  %}
      class="active"
      {% endif %}><a href="#gl_region_search_form" data-toggle="tab" class='btn-default'>Genomic Location</a></li>

  <li  {%if active_tab == 'snpid'%}class="active"{%endif%}><a href="#snpid_search_form" data-toggle="tab" class='btn-default' >SNPid</a></li>

  <li {%if active_tab == 'tf'%}class="active"{%endif%}><a href="#tf_search_form" data-toggle="tab" class='btn-default'>Transcription Factor</a></li>

  <li {%if active_tab == 'snpid-window'%}class="active"{%endif%}><a href="#snpid_window_form" data-toggle="tab" class='btn-default'>Snpid Window</a></li>

  <li {%if active_tab == 'gene-name'%}class="active"{%endif%}><a href="#gene_name_form" data-toggle="tab" class='btn-default'>Gene Name</a></li>

</ul>

<div class="side">

<div id="tabbed-forms" class="tab-content">

<div class="tab-pane panel-body 
   {%if active_tab == 'gl-region' or active_tab == 'none-yet'%} active{%endif%}" id="gl_region_search_form" >
  <form role="form" enctype="multipart/form-data" action="{% url 'ss_viewer:gl-region-search' %}" method="post" >
  {% csrf_token %}
  <div class="form-group">
    <table>
      {{ gl_search_form.as_table }}
    </table>
    <input type="submit" name="action" value="Search by Genomic Location"  class="btn btn-primary" />
      {% if search_paging_info != None and active_tab == 'gl-region' %}
        {% if search_paging_info.show_next_btn == True %}
            <input type="submit" name="action" value="Next" class="btn btn-info" /> 
        {% endif %}
        {% if search_paging_info.show_prev_btn == True %}
            <input type="submit" name="action" value="Prev"  class="btn btn-info" /> 
        {% endif %}
      {% endif %}
  </div>
     {% if search_paging_info != None and active_tab == 'gl-region' %}
       <input type="submit" name="action" 
         value="Download Results" class="btn-xs btn-danger"
         onclick="return confirm('Downloads can take a while,\n and large datasets WILL be truncated. Some restrictions may apply.\n Are you sure you want this download?')" />
     {% endif %}
  </form>
</div>


<div class="tab-pane panel-body
   {%if active_tab == 'snpid'%} active{%endif%}"  id="snpid_search_form" >
  <form role="form" enctype="multipart/form-data" action="{% url 'ss_viewer:snpid-search' %}" method="post">
  {% csrf_token %}
  <div class="form-group">
    <table>
      {{ snpid_search_form.as_table }}
    </table>
    <input type="submit" name="action" value="Search by SNPid"  class="btn btn-primary" />

      {% if search_paging_info != None and active_tab == 'snpid' %}
        {% if search_paging_info.show_next_btn == True %}
            <input type="submit" name="action" value="Next" class="btn btn-info" /> 
        {% endif %}
        {% if search_paging_info.show_prev_btn == True %}
            <input type="submit" name="action" value="Prev"  class="btn btn-info" /> 
        {% endif %}
      {% endif %}
  </div>
     {% if search_paging_info != None and active_tab = 'snpid' %}
       <input type="submit" name="action" 
         value="Download Results" class="btn-xs btn-danger"
         onclick="return confirm('Downloads can take a while,\n and large datasets WILL be truncated. Some restrictions may apply.\n Are you sure you want this download?')" />
     {% endif %}
  </form>
</div>


<div class="tab-pane panel-body
   {%if active_tab == 'tf'%} active{%endif%}"  id="tf_search_form" >
  <form role="form" enctype="multipart/form-data" action="{% url 'ss_viewer:trans-factor-search' %}" method="post">
  {% csrf_token %}
    <div class="form-group">
      <table>
        {{ tf_search_form.as_table }}
      </table>
      <input type="submit" name="action" value="Search by Transcription Factor"  
                                                      class="btn btn-primary" />
      {% if search_paging_info != None and active_tab == 'tf'  %}
        {% if search_paging_info.show_next_btn == True %}
            <input type="submit" name="action" value="Next" class="btn btn-info" /> 
        {% endif %}
        
        {% if search_paging_info.show_prev_btn == True %}
            <input type="submit" name="action" value="Prev"  class="btn btn-info" /> 
        {% endif %}
      {% endif %}

    </div>

     {% if search_paging_info != None and active_tab == 'tf' %}
       <input type="submit" name="action" 
         value="Download Results" class="btn-xs btn-danger"
         onclick="return confirm('Downloads can take a while,\n and large datasets WILL be truncated. Some restrictions may apply.\n Are you sure you want this download?')" />
     {% endif %}

  </form>
</div>


<div class="tab-pane panel-body
   {%if active_tab == 'snpid-window'%} active{%endif%}"  id="snpid_window_form" >
  <form role="form" enctype="multipart/form-data" action="{% url 'ss_viewer:snpid-window-search' %}" method="post">
  {% csrf_token %}
    <div class="form-group">
      <table>
        {{ snpid_window_form.as_table }}
      </table>
      <input type="submit" name="action" value="Search by Window around SNPid"  
                                                      class="btn btn-primary" />
      {% if search_paging_info != None and active_tab == 'snpid-window'  %}
        {% if search_paging_info.show_next_btn == True %}
            <input type="submit" name="action" value="Next" class="btn btn-info" /> 
        {% endif %}
        
        {% if search_paging_info.show_prev_btn == True %}
            <input type="submit" name="action" value="Prev"  class="btn btn-info" /> 
        {% endif %}
      {% endif %}
    </div>

     {% if search_paging_info != None  and active_tab == 'snpid-window' %}
       <input type="submit" name="action" 
         value="Download Results" class="btn-xs btn-danger"
         onclick="return confirm('Downloads can take a while,\n and large datasets WILL be truncated. Some restrictions may apply.\n Are you sure you want this download?')" />
     {% endif %}
  </form>
</div>


<div class="tab-pane panel-body
   {%if active_tab == 'gene-name-window'%} active{%endif%}"  id="gene_name_form" >
  <form role="form" enctype="multipart/form-data" action="{% url 'ss_viewer:gene-name-search' %}" method="post">
  {% csrf_token %}
    <div class="form-group">
      <table>
        {{ gene_name_form.as_table }}
      </table>
      <input type="submit" name="action" value="Search by Gene Name"  
                                                      class="btn btn-primary" />
      {% if search_paging_info != None and active_tab == 'gene-name'  %}
        {% if search_paging_info.show_next_btn == True %}
            <input type="submit" name="action" value="Next" class="btn btn-info" /> 
        {% endif %}
        
        {% if search_paging_info.show_prev_btn == True %}
            <input type="submit" name="action" value="Prev"  class="btn btn-info" /> 
        {% endif %}
      {% endif %}
    </div>

     {% if search_paging_info != None and active_tab == 'gene_name' %}
       <input type="submit" name="action" 
         value="Download Results" class="btn-xs btn-danger"
         onclick="return confirm('Downloads can take a while,\n and large datasets WILL be truncated. Some restrictions may apply.\n Are you sure you want this download?')" />
     {% endif %}
  </form>
</div>


 
</div> <!-- close the 'side' div -->

</div> <!-- close the 'tabbed forms' div -->
<!--  this is the way that we will be displaying the plot -->
<div id="plot" class="side">
</div>


<!-- consider making this part modular; DRYing it up some how... -->
  {% if api_response  %}
  <table class="table table-inverse"> 
    <thead>
    <tr>
        <td>chromosome</td>
        <td>pos</td>
        <td>snpid</td>
        <td>transcription factor</td>
        <td>motif</td>
        <td>motif length</td>
        <td>pval rank</td>
        <td>snp start</td>
        <td>snp end</td>
        <td>ref start</td>
        <td>ref end</td>
        <td>log lik ref</td>
        <td> log lik ratio </td>
        <td>log enhance odds</td>
        <td>log reduce odds</td>
        <td> log lik snp</td>  
        <td> snp strand </td>
        <td> ref strand </td>
        <td> pval ref</td>
        <td> pval snp</td>
        <td>pval cond ref</td>
        <td> pval cond snp</td>
        <td> pval diff</td>
        <td> ref allele </td>

        <td> snp allele </td>
    </tr>
    </thead>
    <tbody>
    {% for onerow in api_response %}
    <tr>   
        <td>{{ onerow.chr }}</td><td>{{ onerow.pos }}</td> 
        <td>{{ onerow.snpid }}</td><td> {{ onerow.trans_factor }}</td>
        <td> {{ onerow.motif }} </td> <td>{{ onerow.motif_len}}</td>
        <td>  {{ onerow.pval_rank|floatformat:4 }} </td>
        <td>{{ onerow.snp_start}} </td><td>{{ onerow.snp_end}}</td><td>{{ onerow.ref_start}}</td>
        <td>{{ onerow.ref_end }} </td>
         <td>{{ onerow.log_lik_ref|floatformat:4 }} </td><td> {{ onerow.log_lik_ratio|floatformat:4}} </td>
        <td>{{ onerow.log_enhance_odds|floatformat:4}}</td><td>{{onerow.log_reduce_odds|floatformat:4}} </td>
        <td>{{ onerow.log_lik_snp|floatformat:4}} </td>  
        <td>{{ onerow.snp_strand }}</td>  <td>{{ onerow.ref_strand }}</td>
        <td>{{ onerow.pval_ref|floatformat:4 }} </td><td>{{ onerow.pval_snp|floatformat:4 }} </td>
        <td>{{ onerow.pval_cond_ref|floatformat:4 }}</td> <td>{{ onerow.pval_cond_snp|floatformat:4}}</td>
        <td>{{ onerow.pval_diff|floatformat:4 }}</td>  
        <td> {{ onerow.refAllele }}</td> 
       <td> {{ onerow.snpAllele }}</td> </tr>
    {%  endfor %}
    <tbody>
  </table>
  {% endif %}


</div> <!-- close the 'content' div -->
</div> <!-- close the 'container' div -->

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <!-- 
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    -->

    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="{% static 'ss_viewer/js/bootstrap.min.js' %}"></script>

<script type="text/javascript">
    jQuery(document).ready(function ($) {
        $('#tabs').tab();
    });
</script>   
<script>
 $(".formcontrol").tooltip({
      position: "bottom left",
      offset: [-2, 10],
      opacity: 0.1
      });
</script>


</body>
